<%@ Page Title="" Language="C#" MasterPageFile="~/master/Site.Master" AutoEventWireup="true" CodeBehind="editor.aspx.cs" Inherits="Malware_FYPJ.page.editor" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
    <style>
        .left {
            float: left;
        }

        .right {
            float: right;
        }

        .tree table {
            width: auto;
        }

            .tree table tbody tr td {
                line-height: 0px;
            }
    </style>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder" runat="server">
    <asp:ScriptManager ID="ScriptManager" runat="server"></asp:ScriptManager>
    <asp:UpdatePanel ID="UpdatePanel" runat="server">
        <ContentTemplate>
            <div>
                <asp:Label ID="lbl_e" runat="server" Visible="False"></asp:Label>
            </div>

            <div class="clearfix" />

            <div>
                <asp:Panel ID="requiredchildPanel" runat="server">
                    <div id="myModal" class="modal fade bs-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-sm">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                    <h4 class="modal-title" id="requiredChildNodesLabel">Required Child Nodes</h4>
                                </div>
                                <div class="modal-body">
                                    Mininum occurence of the following child nodes is specified!
                            <asp:Literal ID="requiredChildNodesLiteral" runat="server"></asp:Literal>
                                </div>
                            </div>
                        </div>
                    </div>
                </asp:Panel>
                <asp:Panel ID="Panel1" ScrollBars="Auto" runat="server">
                    <div class="box">
                        <div class="box-header">
                            <h3>
                                <asp:Image ID="nodeImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_118_embed_close.png" />
                                &nbsp;&nbsp;
                                <asp:Label ID="nodeNameLabel" runat="server"></asp:Label>
                            </h3>
                            <asp:Panel ID="xpathPanel" runat="server"></asp:Panel>
                            <%--<sub>
                                <asp:Label ID="xpathLabel" runat="server"></asp:Label>
                            </sub>--%>
                        </div>
                        <div class="box-content" style="padding: 0;">
                            <!--If have child nodes-->
                            <asp:ListView ID="childNodeListView" runat="server" OnItemCanceling="childNodeListView_ItemCanceling" OnItemInserting="childNodeListView_ItemInserting">
                                <EmptyDataTemplate>
                                    <table id="Table1" runat="server" class="table table-striped">
                                        <tr id="Tr2" runat="server" style="">
                                            <th id="Th1" runat="server">
                                                <div class="left">
                                                    Child Nodes
                                                </div>
                                                <div class="right">
                                                    <asp:Button ID="ChildNodeInsertButton" runat="server" Text="Insert" OnClick="ChildNodeInsertButton_Click" class="btn btn-default btn-xs" />
                                                </div>
                                            </th>
                                        </tr>
                                    </table>
                                </EmptyDataTemplate>
                                <InsertItemTemplate>
                                    <tr style="">
                                        <td>
                                            <div class="left">
                                                <asp:Image ID="childnodeImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_440_folder_closed.png" />
                                                &nbsp;&nbsp;
                                        <asp:DropDownList ID="childNodeDropDownList" runat="server" class="form-control"></asp:DropDownList>
                                                <%--<asp:TextBox ID="childNodeTextBox" runat="server" Text='<%# Bind("NodeName") %>' />--%>
                                            </div>
                                            <div class="right">
                                                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" Text="Insert" class="btn btn-default btn-xs" />
                                                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Clear" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </InsertItemTemplate>
                                <ItemTemplate>
                                    <tr style="">
                                        <td class="landcraft <%# setLastUserModStyle(Eval("ModType").ToString()) %>">
                                            <div class="left">
                                                <asp:Image ID="childnodeImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_440_folder_closed.png" />
                                                &nbsp;&nbsp;
                                        <asp:HyperLink ID="childNodeHyperLink" runat="server" Text='<%# Eval("NodeName") %>' NavigateUrl='<%# getUrl(Eval("Xpath")) %>'></asp:HyperLink>
                                            </div>
                                        </td>
                                    </tr>
                                </ItemTemplate>
                                <LayoutTemplate>
                                    <table id="Table2" runat="server">
                                        <tr id="Tr1" runat="server">
                                            <td id="Td1" runat="server">
                                                <table id="itemPlaceholderContainer" runat="server" border="0" class="table table-striped">
                                                    <tr id="Tr2" runat="server" style="">
                                                        <th id="Th1" runat="server">
                                                            <div class="left">
                                                                Child Nodes
                                                            </div>
                                                            <div class="right">
                                                                <asp:Button ID="ChildNodeInsertButton" runat="server" Text="Insert" OnClick="ChildNodeInsertButton_Click" class="btn btn-default btn-xs" />
                                                            </div>
                                                        </th>
                                                    </tr>
                                                    <tr id="itemPlaceholder" runat="server">
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr id="Tr3" runat="server">
                                            <td id="Td2" runat="server" style=""></td>
                                        </tr>
                                    </table>
                                </LayoutTemplate>
                            </asp:ListView>

                            <!--If have no child nodes-->
                            <asp:ListView ID="valueListView" runat="server" OnItemEditing="valueListView_ItemEditing" OnItemUpdating="valueListView_ItemUpdating" OnItemCanceling="valueListView_ItemCanceling">
                                <EditItemTemplate>
                                    <tr style="">
                                        <td>
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_223_chevron-right.png" />
                                                &nbsp;&nbsp;
                                        <asp:TextBox ID="valueTextBox" runat="server" Text='<%# Bind("Val") %>' />
                                                <asp:Label ID="validatorLabel" runat="server" Text='<%# getValidatorText(Eval("Datatype").ToString()) %>' Style="padding: 5px" class="alert alert-info"></asp:Label>
                                            </div>
                                            <div class="right">
                                                <asp:Button ID="UpdateButton" runat="server" CommandName="Update" Text="Update" class="btn btn-default btn-xs" />
                                                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Cancel" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </EditItemTemplate>
                                <EmptyDataTemplate>
                                    <table id="Table1" runat="server" style="">
                                    </table>
                                </EmptyDataTemplate>
                                <InsertItemTemplate>
                                    <tr style="">
                                        <td>
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_223_chevron-right.png" />
                                                &nbsp;&nbsp;
                                        <asp:TextBox ID="valueTextBox" runat="server" Text='<%# Bind("Val") %>' />
                                            </div>
                                            <div class="right">
                                                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" Text="Insert" class="btn btn-default btn-xs" />
                                                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Clear" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </InsertItemTemplate>
                                <ItemTemplate>
                                    <tr style="">
                                        <td class="landcraft <%# setLastUserModStyle(Eval("ModType").ToString()) %>">
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_223_chevron-right.png" />
                                                &nbsp;&nbsp;
                                        <asp:Label ID="valueLabel" runat="server" Text='<%# Eval("Val") %>'></asp:Label>
                                            </div>
                                            <div class="right hovercraft">
                                                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </ItemTemplate>
                                <LayoutTemplate>
                                    <table id="Table2" runat="server">
                                        <tr id="Tr1" runat="server">
                                            <td id="Td1" runat="server">
                                                <table id="itemPlaceholderContainer" runat="server" border="0" class="table table-striped">
                                                    <tr id="Tr2" runat="server" style="">
                                                        <th id="Th1" runat="server">Value</th>
                                                    </tr>
                                                    <tr id="itemPlaceholder" runat="server">
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr id="Tr3" runat="server">
                                            <td id="Td2" runat="server" style=""></td>
                                        </tr>
                                    </table>
                                </LayoutTemplate>
                            </asp:ListView>

                            <!--If have attributes-->
                            <asp:ListView ID="attributeListView" runat="server" OnItemEditing="attributeListView_ItemEditing" OnItemUpdating="attributeListView_ItemUpdating" OnItemCanceling="attributeListView_ItemCanceling" OnItemInserting="attributeListView_ItemInserting">
                                <EditItemTemplate>
                                    <tr style="">
                                        <td>
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_248_asterisk.png" />
                                                &nbsp;&nbsp;
                                        <asp:Label ID="nameLabel" runat="server" Text='<%# Eval("Name") %>' />
                                                &nbsp;:&nbsp;
                                        <asp:TextBox ID="valueTextBox" runat="server" Text='<%# Bind("Val") %>' />
                                                <asp:Label ID="validatorLabel" runat="server" Style="padding: 5px" class="alert alert-info"></asp:Label>
                                            </div>
                                            <div class="right">
                                                <asp:Button ID="UpdateButton" runat="server" CommandName="Update" Text="Update" class="btn btn-default btn-xs" />
                                                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Cancel" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </EditItemTemplate>
                                <EmptyDataTemplate>
                                    <table id="Table1" runat="server" class="table table-striped">
                                        <tr id="Tr2" runat="server" style="">
                                            <th id="Th1" runat="server">
                                                <div class="left">
                                                    Attributes
                                                </div>
                                                <div class="right">
                                                    <asp:Button ID="AttributesInsertButton" runat="server" Text="Insert" OnClick="AttributesInsertButton_Click" class="btn btn-default btn-xs" />
                                                </div>
                                            </th>
                                        </tr>
                                    </table>
                                </EmptyDataTemplate>
                                <InsertItemTemplate>
                                    <tr style="">
                                        <td>
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_248_asterisk.png" />
                                                &nbsp;&nbsp;
                                        <asp:DropDownList ID="attributeDropDownList" runat="server" class="form-control" AutoPostBack="true" OnSelectedIndexChanged="attributeDropDownList_SelectedIndexChanged" OnLoad="attributeDropDownList_SelectedIndexChanged"></asp:DropDownList>
                                                <%--<asp:TextBox ID="nameTextBox" runat="server" Text='<%# Bind("Name") %>' />--%>
                                        &nbsp;:&nbsp;
                                        <asp:TextBox ID="valueTextBox" runat="server" Text='<%# Bind("Val") %>' />
                                                <%-- TODO --%>
                                                <asp:Label ID="validatorLabel" runat="server" Style="padding: 5px" class="alert alert-info"></asp:Label>
                                            </div>
                                            <div class="right">
                                                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" Text="Insert" class="btn btn-default btn-xs" />
                                                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Clear" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </InsertItemTemplate>
                                <ItemTemplate>
                                    <tr style="">
                                        <td class="landcraft <%# setLastUserModStyle(Eval("ModType").ToString()) %>">
                                            <div class="left">
                                                <asp:Image ID="valueImage" runat="server" ImageUrl="~/images/glyphicons/png/glyphicons_248_asterisk.png" />
                                                &nbsp;&nbsp;
                                        <asp:Label ID="nameLabel" runat="server" Text='<%# Eval("Name") %>'></asp:Label>
                                                &nbsp;:&nbsp;
                                        <asp:Label ID="valueLabel" runat="server" Text='<%# Eval("Val") %>'></asp:Label>
                                            </div>
                                            <div class="right hovercraft">
                                                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" class="btn btn-default btn-xs" />
                                            </div>
                                        </td>
                                    </tr>
                                </ItemTemplate>
                                <LayoutTemplate>
                                    <table id="Table2" runat="server">
                                        <tr id="Tr1" runat="server">
                                            <td id="Td1" runat="server">
                                                <table id="itemPlaceholderContainer" runat="server" border="0" class="table table-striped">
                                                    <tr id="Tr2" runat="server" style="">
                                                        <th id="Th1" runat="server">
                                                            <div class="left">
                                                                Attributes
                                                            </div>
                                                            <div class="right">
                                                                <asp:Button ID="AttributesInsertButton" runat="server" Text="Insert" OnClick="AttributesInsertButton_Click" class="btn btn-default btn-xs" />
                                                            </div>
                                                        </th>
                                                    </tr>
                                                    <tr id="itemPlaceholder" runat="server">
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                        <tr id="Tr3" runat="server">
                                            <td id="Td2" runat="server" style=""></td>
                                        </tr>
                                    </table>
                                </LayoutTemplate>
                            </asp:ListView>
                        </div>
                    </div>
                </asp:Panel>
            </div>

            <div class="right">
            </div>
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Content>
